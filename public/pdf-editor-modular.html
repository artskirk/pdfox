<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFOX - Professional PDF Editor</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@5.0.3/dist/signature_pad.umd.min.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Great+Vibes&family=Pacifico&family=Sacramento&family=Bebas+Neue&display=swap" rel="stylesheet">

    <!-- Application Styles -->
    <link rel="stylesheet" href="/css/pdf-editor.css">
</head>
<body oncontextmenu="if(event.target.tagName !== 'INPUT' && event.target.tagName !== 'TEXTAREA') { event.preventDefault(); return false; }">
    <header class="header">
        <div style="display: flex; align-items: center; gap: 15px;">
            <h1>
                <a href="/" class="header-logo-link">
                <svg width="36" height="36" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="docGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#E50914;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#C40812;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="editGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#E50914;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#B00610;stop-opacity:1" />
                        </linearGradient>
                        <filter id="docShadow" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur in="SourceAlpha" stdDeviation="1.5"/>
                            <feOffset dx="0" dy="2" result="offsetblur"/>
                            <feComponentTransfer><feFuncA type="linear" slope="0.5"/></feComponentTransfer>
                            <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
                        </filter>
                        <filter id="glow">
                            <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                            <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
                        </filter>
                    </defs>
                    <rect x="8" y="6" width="28" height="36" rx="3" fill="url(#docGradient)" filter="url(#docShadow)" stroke="rgba(229,9,20,0.8)" stroke-width="1.5"/>
                    <path d="M36 6 L36 12 L30 12 L36 6 Z" fill="rgba(196,8,18,0.7)"/>
                    <path d="M36 6 L36 12 L30 12" stroke="rgba(229,9,20,0.9)" stroke-width="1" fill="none"/>
                    <line x1="14" y1="16" x2="30" y2="16" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round"/>
                    <line x1="14" y1="21" x2="28" y2="21" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round"/>
                    <line x1="14" y1="26" x2="30" y2="26" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round"/>
                    <line x1="14" y1="31" x2="24" y2="31" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="36" cy="36" r="9" fill="url(#editGradient)" filter="url(#glow)" stroke="rgba(255,255,255,0.9)" stroke-width="2"/>
                    <path d="M32 36 L36 32 L38 34 L34 38 Z" fill="white" opacity="0.95"/>
                    <path d="M38 34 L39 33 L40 34 L39 35 Z" fill="white" opacity="0.95"/>
                    <line x1="32" y1="38" x2="31" y2="39" stroke="white" stroke-width="1.5" stroke-linecap="round" opacity="0.9"/>
                </svg>
                PDFOX
                </a>
            </h1>
        </div>
        <div class="header-actions">
            <button class="header-btn" onclick="document.getElementById('openFileInput').click()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="margin-right: 6px;">
                    <path d="M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z" stroke="currentColor" stroke-width="2"/>
                    <path d="M13 2v7h7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M9 15l3-3 3 3M12 12v7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Open File
            </button>
            <button class="header-btn" onclick="PDFoxApp.goBack()">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" style="margin-right: 6px;">
                    <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Back
            </button>
            <button class="header-btn primary" onclick="PDFoxApp.savePDF()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="margin-right: 6px;">
                    <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="white" stroke-width="2"/>
                    <path d="M7 13l3 3 7-7" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Save PDF
            </button>
        </div>
    </header>

    <input type="file" id="openFileInput" accept=".pdf" style="display: none;">

    <div class="toolbar" id="toolbar">
        <div class="toolbar-visible" id="toolbarVisible">
        <!-- Zoom controls moved to bottom page-controls bar -->

        <!-- GROUP 1: Text Tools - Primary editing workflow -->
        <div class="tool-group" data-group="text" data-priority="2">
            <span class="tool-group-label">Text</span>
            <div class="tool-buttons">
                <button class="tool-btn active" id="editTextTool" data-tool="editText" onclick="PDFoxApp.setTool('editText')" data-tooltip="Click on text to edit it (1)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <small>Edit</small>
                </button>
                <button class="tool-btn" id="addTextTool" data-tool="addText" onclick="PDFoxApp.setTool('addText')" data-tooltip="Click anywhere to add new text (2)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                        <path d="M8 3h8M12 3v2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <small>Add</small>
                </button>
                <button class="tool-btn" id="moveTextTool" data-tool="moveText" onclick="PDFoxApp.setTool('moveText')" data-tooltip="Drag to move or resize added text">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l-3 3-3-3M19 9l3 3-3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="12" cy="12" r="2" fill="currentColor"/>
                    </svg>
                    <small>Move</small>
                </button>
            </div>
        </div>

        <!-- GROUP 2: Selection & Extraction (Hidden - AI Text is activated via Edit tool for image PDFs) -->
        <div class="tool-group" data-group="select" data-priority="3" style="display: none;">
            <span class="tool-group-label">Select</span>
            <div class="tool-buttons">
                <button class="tool-btn" id="ocrSelectTool" data-tool="ocrSelect" onclick="PDFoxApp.setTool('ocrSelect')" data-tooltip="AI-powered text extraction">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" stroke-dasharray="4 2"/>
                        <path d="M8 12h8M12 8v8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <small>AI Text</small>
                </button>
            </div>
        </div>

        <!-- GROUP 2.5: Page Tools -->
        <div class="tool-group" data-group="page" data-priority="6">
            <span class="tool-group-label">Page</span>
            <div class="tool-buttons">
                <button class="tool-btn" id="rotateLeftBtn" onclick="PDFoxApp.rotatePage(-90)" data-tooltip="Rotate page left 90Â°">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M2.5 12a9.5 9.5 0 1 1 2.1 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M2 17l1-5 5 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <small>Left</small>
                </button>
                <button class="tool-btn" id="rotateRightBtn" onclick="PDFoxApp.rotatePage(90)" data-tooltip="Rotate page right 90Â°">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M21.5 12a9.5 9.5 0 1 0-2.1 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M22 17l-1-5-5 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <small>Right</small>
                </button>
                <button class="tool-btn" id="deletePageBtn" onclick="PDFoxApp.deletePage()" data-tooltip="Delete current page">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" stroke="currentColor" stroke-width="2"/>
                        <path d="M14 2v6h6" stroke="currentColor" stroke-width="2"/>
                        <path d="M9 15h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <small>Delete</small>
                </button>
            </div>
        </div>

        <!-- GROUP 3: Annotations - Drawing and shapes -->
        <div class="tool-group" data-group="annotate" data-priority="4">
            <span class="tool-group-label">Annotate</span>
            <div class="tool-buttons">
                <button class="tool-btn" id="drawTool" data-tool="draw" onclick="PDFoxApp.setTool('draw')" data-tooltip="Freehand pen drawing (3)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M12 19l7 2-2-7-7-7-5 5 7 7z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <small>Draw</small>
                </button>
                <button class="tool-btn" id="rectangleTool" data-tool="rectangle" onclick="PDFoxApp.setTool('rectangle')" data-tooltip="Draw a rectangle shape (4)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="6" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <small>Rect</small>
                </button>
                <button class="tool-btn" id="circleTool" data-tool="circle" onclick="PDFoxApp.setTool('circle')" data-tooltip="Draw a circle shape (5)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <small>Circle</small>
                </button>
            </div>
        </div>

        <!-- GROUP 4: Quick Stamps - Fast form filling -->
        <div class="tool-group" data-group="stamps" data-priority="5">
            <span class="tool-group-label">Stamps</span>
            <div class="tool-buttons">
                <button class="tool-btn" id="stampCheck" data-stamp="check" onclick="PDFoxStamps.setStamp('check')" data-tooltip="Checkmark stamp (V)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <small>Check</small>
                </button>
                <button class="tool-btn" id="stampX" data-stamp="x" onclick="PDFoxStamps.setStamp('x')" data-tooltip="X mark stamp (X)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                    </svg>
                    <small>X Mark</small>
                </button>
                <button class="tool-btn" id="stampCircle" data-stamp="circle" onclick="PDFoxStamps.setStamp('circle')" data-tooltip="Circle stamp (O)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <small>Circle</small>
                </button>
                <button class="tool-btn" id="stampDot" data-stamp="dot" onclick="PDFoxStamps.setStamp('dot')" data-tooltip="Filled dot stamp (D)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="6" fill="currentColor" fill-opacity="0.8"/>
                        <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <small>Dot</small>
                </button>
                <button class="tool-btn" id="stampDate" data-stamp="date" onclick="PDFoxStamps.setStamp('date')" data-tooltip="Date stamp - today's date (T)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M3 10h18" stroke="currentColor" stroke-width="2"/>
                        <path d="M8 2v4M16 2v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <small>Date</small>
                </button>
                <button class="tool-btn" id="stampNA" data-stamp="na" onclick="PDFoxStamps.setStamp('na')" data-tooltip="N/A stamp (N)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="2" y="6" width="20" height="12" rx="2" stroke="currentColor" stroke-width="1.5" fill="currentColor" fill-opacity="0.1"/>
                        <text x="12" y="15" text-anchor="middle" font-size="8" font-weight="600" fill="currentColor">N/A</text>
                    </svg>
                    <small>N/A</small>
                </button>
            </div>
        </div>

        <!-- GROUP 5: Sign & Fill - Finalization tools -->
        <div class="tool-group" data-group="finalize" data-priority="6">
            <span class="tool-group-label">Finalize</span>
            <div class="tool-buttons">
                <button class="tool-btn" id="signatureTool" onclick="PDFoxSignatures.openModal()" data-tooltip="Add your signature to the document">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M3 17l2.5-2.5M6 10l4-4 4 4-4 4-4-4z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M14 14l4.5 4.5M18.5 18.5L21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M3 21h4.5" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                    </svg>
                    <small>Sign</small>
                </button>
                <div class="fill-tool-wrapper">
                    <button class="tool-btn" id="fillTool" data-tool="fill" onclick="PDFoxApp.setTool('fill')" data-tooltip="Fill area with selected color (6)">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <!-- Tilted paint bucket -->
                            <path d="M3.5 19.5L9 8l8.5 4.5-5.5 11.5z" stroke="currentColor" stroke-width="1.5" fill="currentColor" fill-opacity="0.1" stroke-linejoin="round"/>
                            <!-- Bucket opening rim -->
                            <ellipse cx="12.5" cy="6.5" rx="4.5" ry="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            <!-- Paint pouring -->
                            <path d="M16 8c1 1.5 2.5 4 2.5 6 0 1.5-1 2.5-2 2.5s-2-1-2-2.5c0-2 1.5-4.5 2.5-6z" fill="currentColor" opacity="0.6"/>
                            <!-- Bucket body connection -->
                            <path d="M8 8.5c0-1.1 2-2 4.5-2s4.5.9 4.5 2" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            <!-- Handle -->
                            <path d="M14.5 4c1.5-1 3-1 4 0" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" fill="none"/>
                        </svg>
                        <small>Fill</small>
                    </button>
                    <label class="fill-color-picker" title="Select fill color">
                        <input type="color" id="fillColorPicker" value="#FFFFFF">
                        <span class="fill-color-swatch" id="fillColorSwatch"></span>
                    </label>
                </div>
                <button class="tool-btn" id="patchTool" data-tool="patch" onclick="PDFoxApp.setTool('patch')" data-tooltip="Patch tool - copy area to cover content (P)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <!-- Bandage/patch icon -->
                        <rect x="2" y="8" width="20" height="8" rx="2" stroke="currentColor" stroke-width="1.5" fill="currentColor" fill-opacity="0.1"/>
                        <line x1="8" y1="8" x2="8" y2="16" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="16" y1="8" x2="16" y2="16" stroke="currentColor" stroke-width="1.5"/>
                        <circle cx="5" cy="12" r="1" fill="currentColor"/>
                        <circle cx="12" cy="12" r="1" fill="currentColor"/>
                        <circle cx="19" cy="12" r="1" fill="currentColor"/>
                    </svg>
                    <small>Patch</small>
                </button>
            </div>
        </div>

        <!-- Hidden inputs for internal use -->
        <input type="color" id="colorPicker" value="#DC1F26" style="display: none;">
        <input type="hidden" id="brushSize" value="3">
        <span id="sizeValue" style="display: none;">3</span>

        <!-- GROUP 5: Actions -->
        <div class="tool-group" data-group="actions" data-priority="7">
            <span class="tool-group-label">Actions</span>
            <div class="tool-buttons">
                <button class="tool-btn" onclick="PDFoxApp.undo()" data-tooltip="Undo last action (Ctrl+Z)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M3 10h10c4 0 7 3 7 7s-3 7-7 7H3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M7 6l-4 4 4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <small>Undo</small>
                </button>
                <button class="tool-btn" onclick="PDFoxApp.redo()" data-tooltip="Redo last action (Ctrl+Y)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M21 10H11c-4 0-7 3-7 7s3 7 7 7h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M17 6l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <small>Redo</small>
                </button>
            </div>
        </div>

        <!-- GROUP 6: Export & Share -->
        <div class="tool-group" data-group="export" data-priority="8">
            <span class="tool-group-label">Export</span>
            <div class="tool-buttons">
                <button class="tool-btn" onclick="PDFoxApp.exportText()" data-tooltip="Export all text to .txt file">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" stroke="currentColor" stroke-width="2"/>
                        <path d="M14 2v6h6" stroke="currentColor" stroke-width="2"/>
                        <path d="M9 13h6M9 17h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <small>Text</small>
                </button>
                <button class="tool-btn" onclick="PDFoxApp.shareLink()" data-tooltip="Generate shareable link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="18" cy="5" r="3" stroke="currentColor" stroke-width="2"/>
                        <circle cx="6" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                        <circle cx="18" cy="19" r="3" stroke="currentColor" stroke-width="2"/>
                        <path d="M8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <small>Share</small>
                </button>
            </div>
        </div>
        </div><!-- end toolbar-visible -->

        <!-- Overflow Menu Group (matches tool-group structure) -->
        <div class="tool-group toolbar-overflow-group" id="toolbarOverflowGroup">
            <span class="tool-group-label">More</span>
            <div class="tool-buttons">
                <button class="tool-btn" id="toolbarOverflowBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="5" r="2" fill="currentColor"/>
                        <circle cx="12" cy="12" r="2" fill="currentColor"/>
                        <circle cx="12" cy="19" r="2" fill="currentColor"/>
                    </svg>
                    <small>Menu</small>
                    <span class="overflow-badge" id="overflowBadge">0</span>
                </button>
            </div>
        </div>

        <!-- Overflow Dropdown -->
        <div class="toolbar-overflow-dropdown" id="toolbarOverflowDropdown"></div>
    </div>

    <div class="main-content">
        <div class="canvas-container">
            <!-- Empty State - Shown before PDF loads -->
            <div class="canvas-empty-state" id="canvasEmptyState">
                <div class="empty-state-content">
                    <!-- Animated Background Pattern -->
                    <div class="empty-state-pattern"></div>

                    <!-- Main Logo -->
                    <div class="empty-state-logo">
                        <svg width="120" height="120" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" class="pdfox-logo-animated">
                            <defs>
                                <linearGradient id="emptyDocGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#E50914;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#C40812;stop-opacity:1" />
                                </linearGradient>
                                <linearGradient id="emptyEditGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#E50914;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#B00610;stop-opacity:1" />
                                </linearGradient>
                                <filter id="emptyGlow" x="-50%" y="-50%" width="200%" height="200%">
                                    <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                    <feMerge>
                                        <feMergeNode in="coloredBlur"/>
                                        <feMergeNode in="SourceGraphic"/>
                                    </feMerge>
                                </filter>
                                <filter id="emptyShadow" x="-50%" y="-50%" width="200%" height="200%">
                                    <feGaussianBlur in="SourceAlpha" stdDeviation="2"/>
                                    <feOffset dx="0" dy="4" result="offsetblur"/>
                                    <feComponentTransfer><feFuncA type="linear" slope="0.3"/></feComponentTransfer>
                                    <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
                                </filter>
                            </defs>
                            <!-- Document body -->
                            <rect x="8" y="6" width="28" height="36" rx="3" fill="url(#emptyDocGradient)" filter="url(#emptyShadow)" stroke="rgba(229,9,20,0.8)" stroke-width="1.5" class="doc-body"/>
                            <!-- Folded corner -->
                            <path d="M36 6 L36 12 L30 12 L36 6 Z" fill="rgba(196,8,18,0.7)" class="doc-fold"/>
                            <path d="M36 6 L36 12 L30 12" stroke="rgba(229,9,20,0.9)" stroke-width="1" fill="none"/>
                            <!-- Text lines -->
                            <line x1="14" y1="16" x2="30" y2="16" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round" class="text-line line-1"/>
                            <line x1="14" y1="21" x2="28" y2="21" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round" class="text-line line-2"/>
                            <line x1="14" y1="26" x2="30" y2="26" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round" class="text-line line-3"/>
                            <line x1="14" y1="31" x2="24" y2="31" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round" class="text-line line-4"/>
                            <!-- Edit circle -->
                            <circle cx="36" cy="36" r="9" fill="url(#emptyEditGradient)" filter="url(#emptyGlow)" stroke="rgba(255,255,255,0.9)" stroke-width="2" class="edit-circle"/>
                            <!-- Pencil -->
                            <path d="M32 36 L36 32 L38 34 L34 38 Z" fill="white" opacity="0.95" class="pencil-body"/>
                            <path d="M38 34 L39 33 L40 34 L39 35 Z" fill="white" opacity="0.95" class="pencil-tip"/>
                            <line x1="32" y1="38" x2="31" y2="39" stroke="white" stroke-width="1.5" stroke-linecap="round" opacity="0.9"/>
                        </svg>
                    </div>

                    <!-- Brand Name -->
                    <h2 class="empty-state-title">PDFOX</h2>
                    <p class="empty-state-subtitle">Professional PDF Editor</p>

                    <!-- Loading indicator -->
                    <div class="empty-state-loader">
                        <div class="loader-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <p class="loader-text">Loading your document...</p>
                    </div>

                    <!-- Drop zone hint -->
                    <div class="empty-state-hint">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>Drop a PDF file or click "Open File" to begin</span>
                    </div>
                </div>
            </div>

            <div class="pdf-viewer" id="pdfViewer">
                <canvas id="pdfCanvas"></canvas>
                <div id="textLayer"></div>
                <div id="overlayLayer"></div>
                <canvas id="annotationCanvas"></canvas>
            </div>
        </div>

        <div class="sidebar">
            <!-- Layers Panel (Primary Focus) -->
            <div class="layers-panel" style="margin-bottom: 20px;">
                <div class="layers-panel-header">
                    <h4>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="12 2 2 7 12 12 22 7 12 2"/>
                            <polyline points="2 17 12 22 22 17"/>
                            <polyline points="2 12 12 17 22 12"/>
                        </svg>
                        Layers
                        <span class="layer-count" id="layerCount">0</span>
                    </h4>
                </div>
                <div class="layers-list" id="layersList">
                    <div class="layers-empty">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <polygon points="12 2 2 7 12 12 22 7 12 2"/>
                            <polyline points="2 17 12 22 22 17"/>
                            <polyline points="2 12 12 17 22 12"/>
                        </svg>
                        <div>No layers yet</div>
                        <div style="font-size: 11px; margin-top: 4px;">Edit or add text to create layers</div>
                    </div>
                </div>
            </div>

            <!-- Document Settings -->
            <div class="property-group" style="padding: 16px; background: #1a1a1a; border-radius: 10px; border: 1px solid #333;">
                <h4 style="margin: 0 0 12px 0; color: #fff; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
                    </svg>
                    Document
                </h4>
                <label class="property-label" style="font-size: 12px; color: #888; margin-bottom: 6px; display: block;">File Name</label>
                <input type="text" id="docName" class="property-input" value="Edited PDF" style="width: 100%; padding: 10px 12px; background: #2a2a2a; border: 1px solid #444; border-radius: 8px; color: #fff; font-size: 14px;">
            </div>

            <!-- Keyboard Shortcuts -->
            <div class="property-group" style="margin-top: 16px; padding: 16px; background: #1a1a1a; border-radius: 10px; border: 1px solid #333;">
                <h4 style="margin: 0 0 12px 0; color: #fff; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="4" width="20" height="16" rx="2"/>
                        <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M8 12h8M6 16h.01M18 16h.01"/>
                    </svg>
                    Shortcuts
                </h4>
                <div style="display: flex; flex-direction: column; gap: 8px; font-size: 12px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #888;">Save PDF</span>
                        <kbd style="background: #2a2a2a; padding: 4px 8px; border-radius: 4px; color: #E50914; font-family: monospace; font-size: 11px;">Ctrl+S</kbd>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #888;">Undo</span>
                        <kbd style="background: #2a2a2a; padding: 4px 8px; border-radius: 4px; color: #E50914; font-family: monospace; font-size: 11px;">Ctrl+Z</kbd>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #888;">Redo</span>
                        <kbd style="background: #2a2a2a; padding: 4px 8px; border-radius: 4px; color: #E50914; font-family: monospace; font-size: 11px;">Ctrl+Y</kbd>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #888;">Zoom In/Out</span>
                        <kbd style="background: #2a2a2a; padding: 4px 8px; border-radius: 4px; color: #E50914; font-family: monospace; font-size: 11px;">+ / -</kbd>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #888;">Delete selected</span>
                        <kbd style="background: #2a2a2a; padding: 4px 8px; border-radius: 4px; color: #E50914; font-family: monospace; font-size: 11px;">Delete</kbd>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #888;">Close modal</span>
                        <kbd style="background: #2a2a2a; padding: 4px 8px; border-radius: 4px; color: #E50914; font-family: monospace; font-size: 11px;">Esc</kbd>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Page & Zoom Controls -->
    <div class="page-controls" id="pageControls">
        <!-- Page Navigation -->
        <div class="page-nav-group">
            <button class="control-btn" id="prevPage" onclick="PDFoxRenderer.prevPage()" data-tooltip="Previous page">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <span class="page-info" id="pageInfo">1 / 1</span>
            <button class="control-btn" id="nextPage" onclick="PDFoxRenderer.nextPage()" data-tooltip="Next page">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>

        <div class="controls-divider"></div>

        <!-- Zoom Controls -->
        <div class="zoom-nav-group">
            <button class="control-btn" id="zoomOutBtn" onclick="PDFoxApp.zoomOut()" data-tooltip="Zoom out (-)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/>
                    <path d="M21 21l-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="zoom-dropdown-container" id="zoomDropdownContainer">
                <button class="zoom-dropdown-trigger" id="zoomDropdownTrigger" data-tooltip="Zoom level">
                    <span class="zoom-display" id="zoomDisplay">100%</span>
                    <svg class="zoom-dropdown-arrow" width="8" height="8" viewBox="0 0 24 24" fill="none">
                        <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <div class="zoom-dropdown-menu" id="zoomDropdownMenu">
                    <div class="zoom-dropdown-section">
                        <button class="zoom-dropdown-item" data-zoom="fit">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                                <path d="M3 9h18M9 3v18" stroke="currentColor" stroke-width="1.5" stroke-dasharray="2 2" opacity="0.5"/>
                            </svg>
                            Fit to View
                            <span class="shortcut">0</span>
                        </button>
                        <button class="zoom-dropdown-item" data-zoom="width">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <rect x="2" y="4" width="20" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                                <path d="M6 12h12M6 12l2-2M6 12l2 2M18 12l-2-2M18 12l-2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Fit to Width
                        </button>
                    </div>
                    <div class="zoom-dropdown-divider"></div>
                    <div class="zoom-dropdown-section zoom-presets">
                        <button class="zoom-dropdown-item" data-zoom="0.25">25%</button>
                        <button class="zoom-dropdown-item" data-zoom="0.5">50%</button>
                        <button class="zoom-dropdown-item" data-zoom="0.75">75%</button>
                        <button class="zoom-dropdown-item" data-zoom="1.0">100%</button>
                        <button class="zoom-dropdown-item" data-zoom="1.25">125%</button>
                        <button class="zoom-dropdown-item" data-zoom="1.5">150%</button>
                        <button class="zoom-dropdown-item" data-zoom="2.0">200%</button>
                        <button class="zoom-dropdown-item" data-zoom="3.0">300%</button>
                    </div>
                </div>
            </div>
            <button class="control-btn" id="zoomInBtn" onclick="PDFoxApp.zoomIn()" data-tooltip="Zoom in (+)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/>
                    <path d="M21 21l-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Annotation Style Panel -->
    <div class="annotation-style-panel" id="annotationStylePanel">
        <button class="style-panel-close" onclick="PDFoxAnnotationStyles.hide()" title="Close">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
        </button>
        <div class="annotation-style-panel-inner">
            <!-- Stroke Color -->
            <div class="style-group">
                <span class="style-group-label">Stroke</span>
                <div class="style-group-content">
                    <input type="color" id="annotationStrokeColor" class="style-color-picker" value="#E50914" title="Stroke Color">
                </div>
            </div>

            <!-- Fill (for shapes only) -->
            <div class="style-group" id="fillStyleGroup">
                <span class="style-group-label">Fill</span>
                <div class="style-group-content">
                    <button class="style-fill-toggle" id="fillToggle" onclick="PDFoxAnnotationStyles.toggleFill()" title="Toggle Fill">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <input type="color" id="annotationFillColor" class="style-color-picker" value="#E50914" title="Fill Color" disabled>
                </div>
            </div>

            <div class="style-divider"></div>

            <!-- Opacity -->
            <div class="style-group">
                <span class="style-group-label">Opacity</span>
                <div class="style-group-content style-opacity-container">
                    <input type="range" id="annotationOpacity" class="style-slider" min="10" max="100" value="100">
                    <span class="style-value" id="opacityValue">100%</span>
                </div>
            </div>

            <div class="style-divider"></div>

            <!-- Line Style -->
            <div class="style-group">
                <span class="style-group-label">Line Style</span>
                <div class="style-group-content style-line-options">
                    <button class="style-line-btn active" data-line-style="solid" onclick="PDFoxAnnotationStyles.setLineStyle('solid')" title="Solid">
                        <svg width="20" height="4" viewBox="0 0 20 4">
                            <line x1="0" y1="2" x2="20" y2="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <button class="style-line-btn" data-line-style="dashed" onclick="PDFoxAnnotationStyles.setLineStyle('dashed')" title="Dashed">
                        <svg width="20" height="4" viewBox="0 0 20 4">
                            <line x1="0" y1="2" x2="20" y2="2" stroke="currentColor" stroke-width="2" stroke-dasharray="4 2"/>
                        </svg>
                    </button>
                    <button class="style-line-btn" data-line-style="dotted" onclick="PDFoxAnnotationStyles.setLineStyle('dotted')" title="Dotted">
                        <svg width="20" height="4" viewBox="0 0 20 4">
                            <line x1="0" y1="2" x2="20" y2="2" stroke="currentColor" stroke-width="2" stroke-dasharray="2 2"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="style-divider"></div>

            <!-- Size -->
            <div class="style-group">
                <span class="style-group-label">Size</span>
                <div class="style-group-content style-size-container">
                    <input type="range" id="annotationSize" class="style-size-slider" min="1" max="20" value="3">
                    <span class="style-value" id="sizeValueDisplay">3px</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Legacy Edit/Add Text Modals - Now replaced by Unified Text Editor -->
    <!-- These modals are no longer used - the unified text editor handles all text operations -->

    <!-- Signature Modal -->
    <div id="signatureModal" class="custom-modal" style="display: none;">
        <div class="signature-modal-content">
            <div class="signature-modal-header">
                <h2>
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                        <path d="M3 17l2.5-2.5M6 10l4-4 4 4-4 4-4-4z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M14 14l4.5 4.5M18.5 18.5L21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M3 21h4.5" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                    </svg>
                    Add Signature
                </h2>
            </div>

            <div class="signature-tabs">
                <button class="signature-tab active" data-tab="draw" onclick="PDFoxSignatures.switchTab('draw')">Draw</button>
                <button class="signature-tab" data-tab="type" onclick="PDFoxSignatures.switchTab('type')">Type</button>
                <button class="signature-tab" data-tab="upload" onclick="PDFoxSignatures.switchTab('upload')">Upload</button>
            </div>

            <!-- Draw Tab -->
            <div id="signatureTab-draw" class="signature-tab-content active">
                <div class="signature-canvas-container">
                    <canvas id="signatureCanvas" width="540" height="200"></canvas>
                </div>
                <div class="signature-canvas-controls">
                    <button class="modal-btn modal-btn-secondary" onclick="PDFoxSignatures.clearCanvas()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 6px;">
                            <path d="M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Clear
                    </button>
                    <span class="signature-hint">Sign above with your mouse or touchscreen</span>
                </div>
                <label class="signature-checkbox-option">
                    <input type="checkbox" id="signatureTransparentBg" checked>
                    <span class="checkbox-custom"></span>
                    <span class="checkbox-label">Transparent Background</span>
                </label>
            </div>

            <!-- Type Tab -->
            <div id="signatureTab-type" class="signature-tab-content">
                <input type="text" id="typeSignatureInput" class="type-signature-input" placeholder="Type your name..." maxlength="50" oninput="PDFoxSignatures.updateTypedPreview()">

                <div class="signature-color-picker">
                    <label>Signature Color:</label>
                    <input type="color" id="typeSignatureColor" value="#000000">
                </div>

                <div class="font-selector">
                    <div class="font-option selected" data-font="Dancing Script" style="font-family: 'Dancing Script', cursive;" onclick="PDFoxSignatures.selectFont(this, 'Dancing Script')">
                        <span>Signature</span>
                    </div>
                    <div class="font-option" data-font="Great Vibes" style="font-family: 'Great Vibes', cursive;" onclick="PDFoxSignatures.selectFont(this, 'Great Vibes')">
                        <span>Signature</span>
                    </div>
                    <div class="font-option" data-font="Pacifico" style="font-family: 'Pacifico', cursive;" onclick="PDFoxSignatures.selectFont(this, 'Pacifico')">
                        <span>Signature</span>
                    </div>
                    <div class="font-option" data-font="Sacramento" style="font-family: 'Sacramento', cursive;" onclick="PDFoxSignatures.selectFont(this, 'Sacramento')">
                        <span>Signature</span>
                    </div>
                </div>
            </div>

            <!-- Upload Tab -->
            <div id="signatureTab-upload" class="signature-tab-content">
                <div class="upload-area" id="signatureUploadArea" onclick="document.getElementById('signatureFileInput').click()">
                    <div class="upload-icon">ðŸ“„</div>
                    <div class="upload-text">Click to upload or drag & drop</div>
                    <div class="upload-hint">PNG or JPG â€¢ Max 5MB â€¢ Background will be removed</div>
                </div>
                <input type="file" id="signatureFileInput" accept="image/png,image/jpeg" onchange="PDFoxSignatures.handleUpload(event)" style="display: none;">

                <div id="signaturePreviewContainer" class="signature-preview-container" style="display: none;">
                    <img id="signaturePreviewImg" class="signature-preview" alt="Signature preview">
                </div>
            </div>

            <div class="signature-modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="PDFoxSignatures.closeModal()">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="PDFoxSignatures.apply()">Apply Signature</button>
            </div>
        </div>
    </div>

    <!-- Share Link Modal -->
    <div id="shareLinkModal" class="custom-modal" style="display: none;">
        <div class="custom-modal-content" style="max-width: 480px; text-align: left;">
            <div style="margin-bottom: 20px;">
                <h3 style="font-size: 22px; color: #ffffff; margin: 0 0 8px 0; display: flex; align-items: center; gap: 10px;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#E50914" stroke-width="2">
                        <circle cx="18" cy="5" r="3"/>
                        <circle cx="6" cy="12" r="3"/>
                        <circle cx="18" cy="19" r="3"/>
                        <path d="M8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98"/>
                    </svg>
                    Share Document
                </h3>
                <p style="font-size: 13px; color: #999; margin: 0;">Generate a shareable link for this PDF</p>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #aaaaaa; font-size: 14px;">Shareable Link:</label>
                <div style="display: flex; gap: 8px;">
                    <input type="text" id="shareUrlInput" readonly style="flex: 1; padding: 12px; border: 2px solid #333; border-radius: 8px; font-size: 13px; background: #2a2a2a; color: #ffffff; box-sizing: border-box;">
                    <button onclick="PDFoxApp.copyShareLink()" style="padding: 12px 16px; background: #E50914; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; white-space: nowrap;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" style="vertical-align: middle; margin-right: 4px;">
                            <rect x="9" y="9" width="13" height="13" rx="2"/>
                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                        </svg>
                        Copy
                    </button>
                </div>
                <p id="shareLinkStatus" style="font-size: 12px; color: #888; margin-top: 8px;"></p>
            </div>

            <div style="padding: 12px; background: rgba(229, 9, 20, 0.1); border-radius: 8px; border: 1px solid rgba(229, 9, 20, 0.3); margin-bottom: 20px;">
                <p style="font-size: 12px; color: #ccc; margin: 0;">
                    <strong style="color: #E50914;">Note:</strong> The link will be valid for 24 hours. Anyone with this link can view the document.
                </p>
            </div>

            <div style="margin-top: 20px; display: flex; gap: 12px; justify-content: flex-end;">
                <button onclick="PDFoxApp.closeShareModal()" style="padding: 12px 24px; background: #2a2a2a; color: #ffffff; border: 2px solid #333; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 14px;">Close</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading" id="loading" style="display: none;">
        <div class="loading-content">
            <div class="spinner"></div>
            <div>Processing PDF...</div>
        </div>
    </div>

    <!-- Initialize PDF.js Worker -->
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>

    <!-- PDF Storage Module for large files -->
    <script src="/js/pdf-storage.js"></script>

    <!-- Application Modules (order matters for dependencies) -->
    <script src="/js/modules/utils.js"></script>
    <script src="/js/modules/core.js"></script>
    <script src="/js/modules/ui.js"></script>
    <script src="/js/modules/unified-text-editor.js"></script>
    <script src="/js/modules/toolbar.js"></script>
    <script src="/js/modules/pdf-renderer.js"></script>
    <script src="/js/modules/text-editor.js"></script>
    <script src="/js/modules/layers.js"></script>
    <script src="/js/modules/annotation-styles.js"></script>
    <script src="/js/modules/annotations.js"></script>
    <script src="/js/modules/signatures.js"></script>
    <script src="/js/modules/stamps.js"></script>
    <script src="/js/modules/patch.js"></script>
    <script src="/js/modules/overlays.js"></script>
    <script src="/js/modules/ocr.js"></script>
    <script src="/js/modules/context-menu.js"></script>
    <script src="/js/modules/app.js"></script>

    <!-- Initialize Application -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            PDFoxApp.init();
            PDFoxToolbar.init();
            PDFoxOCR.init();
            PDFoxAnnotationStyles.init();
            PDFoxContextMenu.init();
        });
    </script>
</body>
</html>
